---
title: "Autovalores y autovectores "
author: "Karina Bartolom√©"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning=FALSE)
```

```{r, message=FALSE}
library(tidyverse)
```

# Matrices en R:

Matriz identidad de 2x2:

```{r}
I = diag(2)
I
```

Se define una matriz A (m x n):

```{r, echo=TRUE}
A <- t(matrix(c(0, 2, 
                2, 4), 
              nrow = 2, ncol = 2))
A
```

Gr√°ficamente:

```{r}
 data.frame(A) %>% 
    ggplot()+
    
    geom_hline(yintercept=0)+
    geom_vline(xintercept=0)+
    
    geom_segment(aes(x=0,xend=X1, y=0, yend=X2), 
                     arrow= arrow(length = unit(0.1, "inches")), 
                 show.legend = TRUE,size=0.9, color='red')+
  
    geom_text(aes(x=X1, y=X2, 
                  label=paste0('A=(',round(X1,2),',',round(X2,2),')')),
              nudge_x=0.2, nudge_y=0.1, size=3, color='red')+
    
    theme_bw()+
  
    scale_y_continuous(expand = expansion(mult = 0.3))+
    scale_x_continuous(expand = expansion(mult = 0.3))+
    
    labs(title='Representaci√≥n de la matriz A en dos ejes')
```

# Autovalores y autovectores

Dados

$A ‚àà ùöÅ_{nn}$ , $Œª ‚àà ùöÅ$ , $V ‚àà ùöÅ_{n1}$

Se dice que **Œª** es un **autovalor** de A si y s√≥lo si existe un vector **V** (**autovector**) no nulo tal que:

A V = Œª V

# C√°lculo de autovalores (eigenvalues)

Existen tantos autovalores como n√∫mero de filas (m) o columnas (n) tiene la matriz original.

A V ‚àíŒª V = 0

( A ‚àí Œª I ) V = 0

\| A ‚àí Œª I \| = 0 --\> **Ecuaci√≥n caracter√≠stica de la matriz A**

En donde

p(Œª)=\|A‚ÄìŒªI\| es un polinomio de grado n dependiente de Œª --\> **polinomio caracter√≠stico de la matriz A**

------------------------------------------------------------------------

Si Œª = 2 =\> A - 2 \* I :

```{r}
lambda = 2
A - lambda * I
```

Calculando el determinante \| A ‚àí Œª I \|

```{r}
det(A - lambda*I)
```

No es igual a 0, con lo cual Œª = 2 no es un autovalor de la matriz A.

Calculando los autovalores que resuelvan la ecuaci√≥n:

```{r, echo=TRUE}
autovalores <- eigen(A)$values
autovalores
```

Notar que si se calcula el determinante \| A ‚àí Œª I \| para estos autovalores da 0:

```{r, echo=TRUE}
det(A - autovalores[1]*I)
```

```{r, echo=TRUE}
det(A - autovalores[2]*I)
```

(puede no dar 0 exacto por redondeos en el c√°lculo de los autovalores)

# C√°lculo de autovectores

Autovectores:

```{r, echo=TRUE}
autovectores <- eigen(A)$vectors
autovectores
```

# Volviendo a A V = Œª V

```{r, echo=TRUE}
round(A %*% autovectores[,1],3) == round(matrix(autovectores[,1] * 
                                            autovalores[1], nrow=2),3)
```

A V :

```{r, echo=TRUE}
AX1 = A %*% autovectores[1,]
AX2 = A %*% autovectores[2,]
```

Œª V :

```{r, echo=TRUE}
X1L1 = autovectores[1,] * autovalores[1]
X2L2 = autovectores[2,] * autovalores[2]
```

```{r, echo=TRUE}
print(X1L1)
print(AX2)

print(X2L2)
print(AX1)
```

# Gr√°ficamente:

```{r}
plot_eigen <- function(.matriz){
  
  # C√°lculo de autovalores y autovectores
  autovalores  <- eigen(.matriz)$values
  autovectores <- eigen(.matriz)$vectors

  # A * X = lambda * X
  AX1 = .matriz %*% autovectores[,1]
  AX2 = .matriz %*% autovectores[,2]
  
  data.frame(.matriz) %>% 
    ggplot()+
    
    geom_hline(yintercept=0)+
    geom_vline(xintercept=0)+
    
    
    # AX
    geom_segment(aes(x=0,xend=AX1[1], y=0, yend=AX1[2], color='A x1 = L1 x1'), 
                     arrow= arrow(length = unit(0.1, "inches")), 
                 show.legend = TRUE,size=0.7)+
  
    
    geom_segment(aes(x=0,xend=AX2[1], y=0, yend=AX2[2], color='A x2 = L2 x2'), 
                     arrow= arrow(length = unit(0.1, "inches")), 
                 show.legend = TRUE,size=0.7)+

    
    
    # Matriz A
    geom_segment(aes(x=0,xend=X1, y=0, yend=X2, color='Matriz A'), 
                     arrow= arrow(length = unit(0.1, "inches")), 
                 show.legend = TRUE,size=0.7)+
    
      
    
    # Autovectores
    geom_segment(data=data.frame(t(autovectores)),
                 aes(x=0,xend=X1, y=0, yend=X2, color='Autovectores'), 
                     arrow= arrow(length = unit(0.1, "inches")), 
                 show.legend = TRUE, size=0.7)+
    
    
    theme_bw()+
    
    scale_color_manual(values=c('A x1 = L1 x1'='red',
                                'A x2 = L2 x2'='red',
                                'Matriz A'='green',
                                'Autovectores'='blue'))+
    
    scale_y_continuous(expand = expansion(mult = 0.3))+
    scale_x_continuous(expand = expansion(mult = 0.3))+
    
    labs(title='Representaci√≥n de autovalores y autovectores',
         subtitle=paste0('Autovalores: ',
                         round(autovalores[1],2),' y ', 
                         round(autovalores[2],2), '\n',
                         'Autovectores:',
                         '(',paste0(round(autovectores[,1],2), 
                                    collapse=', '), ') y ',
                         '(',paste0(round(autovectores[,2],2), 
                                    collapse=', '),')'),
         color = 'Vector')
  
}
```

Visualizando el ejemplo de la matriz A. Se observa que se cumple la igualdad A V = Œª V.

Adem√°s, se ve como para cada autovector (X1 y X2):

$$A * X_1=Œª_1*X_1$$

$$A * X_2=Œª_2*X_2$$

Cuando el autovalor es positivo, el autovector V se expande en la misma direcci√≥n mientras que cuando el autovalor es negativo el autovector V se expande en la direcci√≥n opuesta.

```{r, fig.height=4, fig.width=10}
plot_eigen(A)
```

Considerando una matriz A distinta:

```{r, fig.height=4, fig.width=10}
A <- matrix(c(3,2,
              1,4), nrow=2, ncol=2)
A
plot_eigen(A)
```

Otro ejemplo:

```{r, fig.height=4, fig.width=10}
A <- matrix(c(1,2,
              3,4), nrow=2, ncol=2)
A
plot_eigen(A)
```

# Links

[Eigenvectors and Eigenvalues Explained Visually](https://setosa.io/ev/eigenvectors-and-eigenvalues/)
