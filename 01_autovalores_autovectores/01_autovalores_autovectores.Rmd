---
title: "Autovalores y autovectores"
author: "Karina Bartolomé"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning=FALSE)
```


```{r, message=FALSE}
library(tidyverse)
library(geomtextpath)
```

# Matrices en R:

Matriz identidad:

```{r}
I = diag(2)
I
```

# Autovalores y autovectores

Los autovalores son escalares que al ser multiplicados por un vector no negativo se cumple la igualdad: 

A x = λ x

# Cálculo de autovalores (eigenvalues)

A x−λ x = 0  

( A − λ I ) x = 0

\| A − λ I \| = 0 --\> **Ecuación característica**

Se define una matriz A:

```{r, echo=TRUE}
A <- t(matrix(c(0, 1, 1, 0), nrow = 2, ncol = 2))
A
```

Si λ = 3 =\> A - 3 \* I :

```{r}
lambda = 2
A - lambda * I
```

Calculando el determinante \| A − λ I \|

```{r}
det(A - lambda*I)
```

No es igual a 0, con lo cual λ = 2 no es un autovalor de la matriz A.

Calculando los autovalores que resuelvan la ecuación:

```{r, echo=TRUE}
autovalores <- eigen(A)$values
autovalores
```

Notar que si se calcula el determinante \| A − λ I \| para estos autovalores da 0:

```{r, echo=TRUE}
det(A - autovalores[1]*I)
```

```{r, echo=TRUE}
det(A - autovalores[2]*I)
```


# Cálculo de autovectores

Autovectores:

```{r, echo=TRUE}
autovectores <- eigen(A)$vectors
autovectores
```

# Volviendo a A x = λ x

```{r, echo=TRUE}
A %*% autovectores[,1] == matrix(autovectores[,1] * autovalores[1], nrow=2)
```


A x : 

```{r, echo=TRUE}
AX1 = A %*% autovectores[1,]
AX2 = A %*% autovectores[2,]
```

λ x : 

```{r, echo=TRUE}
X1L1 = autovectores[1,] * autovalores[1]
X2L2 = autovectores[2,] * autovalores[2]
```

```{r, echo=TRUE}
print(X1L1)
print(AX2)

print(X2L2)
print(AX1)
```

# Gráficamente: 

Función para obtener autovalores y autovectores:


```{r}
plot_eigen <- function(.matriz){
  
  # Cálculo de autovalores y autovectores
  autovalores  <- eigen(.matriz)$values
  autovectores <- eigen(.matriz)$vectors

  # A * X = lambda * X
  AX1 = .matriz %*% autovectores[,1]
  AX2 = .matriz %*% autovectores[,2]
  
  data.frame(.matriz) %>% 
    ggplot()+
    
    geom_hline(yintercept=0)+
    geom_vline(xintercept=0)+
    
    
    # AX
    geom_segment(aes(x=0,xend=AX1[1], y=0, yend=AX1[2], color='A x1 = L1 x1'), 
                     arrow= arrow(length = unit(0.1, "inches")), 
                 show.legend = TRUE,size=0.7)+
  
    
    geom_segment(aes(x=0,xend=AX2[1], y=0, yend=AX2[2], color='A x2 = L2 x2'), 
                     arrow= arrow(length = unit(0.1, "inches")), 
                 show.legend = TRUE,size=0.7)+

    
    
    # Matriz A
    geom_segment(aes(x=0,xend=X1, y=0, yend=X2, color='Matriz A'), 
                     arrow= arrow(length = unit(0.1, "inches")), 
                 show.legend = TRUE,size=0.7)+
    
        
    # geom_text(aes(x=X1, y=X2, color='Matriz A', 
    #               label=paste0('A=(',round(X1,2),',',round(X2,2),')')),
    #           nudge_x=0.1, nudge_y=-0.5, size=3)+
    
    # Autovectores
    geom_segment(data=data.frame(t(autovectores)),
                 aes(x=0,xend=X1, y=0, yend=X2, color='Autovectores'), 
                     arrow= arrow(length = unit(0.1, "inches")), 
                 show.legend = TRUE, size=0.7)+
    
    # geom_text(data=data.frame(t(autovectores)), 
    #           aes(x=X1, y=X2, color='Autovectores', 
    #               label=paste0('V=(',round(X1,1),',',round(X2,1),')')),
    #           nudge_x=0.1, nudge_y=-0.5, size=3)+
    
    
    theme_bw()+
    
    scale_color_manual(values=c('A x1 = L1 x1'='red',
                                'A x2 = L2 x2'='red',
                                'Matriz A'='green',
                                'Autovectores'='blue'))+
    
    scale_y_continuous(expand = expansion(mult = 0.3))+
    scale_x_continuous(expand = expansion(mult = 0.3))+
    
    labs(title='Representación geométrica de autovalores y autovectores',
         subtitle=paste0('Autovalores: ',
                         round(autovalores[1],2),' y ', 
                         round(autovalores[2],2), '\n',
                         'Autovectores:',
                         '(',paste0(round(autovectores[,1],2), 
                                    collapse=', '), ') y ',
                         '(',paste0(round(autovectores[,2],2), 
                                    collapse=', '),')'),
         color = 'Vector')
  
}
```

Visualizando el ejemplo de la matriz A:

```{r, fig.height=3, fig.width=5}
plot_eigen(A)
```

Considerando una matriz A distinta: 

```{r, fig.height=3, fig.width=5}
A <- matrix(c(0,2,2,4), nrow=2, ncol=2)
plot_eigen(A)
```

Otro ejemplo: 

```{r, fig.height=3, fig.width=5}
A <- matrix(c(1,2,3,4), nrow=2, ncol=2)
plot_eigen(A)
```






